---
title: "Using Cowplot to add logos to ggplots"
output: github_document
layout: post
---

```{r setup}
knitr::opts_chunk$set(echo=FALSE,include=FALSE)
library(tidyverse)
library(cowplot)
library(here)
library(png)
library(grid)

github_path <- here("images","github64.png")
github <- rasterGrob(readPNG(github_path))

plots <- list()
plots$p1 <-
  mtcars %>%
  ggplot(aes(x=cyl,y=hp)) +
  geom_point() +
  theme_bw() +
  expand_limits(x=c(2,10),y=c(0,400))

plots$p2 <-
  mtcars %>%
  ggplot(aes(x=mpg,y=disp)) +
  geom_point() +
  theme_bw() +
  expand_limits(x=c(8),y=c(0,500))
```

If you use freely available data in your work, it's polite to give credit. You can do this with a text caption or by placing a logo inside your image.

In ggplot you can add a text caption easily, but an image is a more complicated.

```{r annotation-code,echo=TRUE,include=TRUE,eval=FALSE}
annotation_custom(github, xmin=8, xmax=10, ymin=300, ymax=400)
```
```{r annotation}
grid1 <- plot_grid(
  plots$p1 + annotation_custom(github, xmin=8, xmax=10, ymin=300, ymax=400), 
  plots$p2 + annotation_custom(github, xmin=8, xmax=10, ymin=300, ymax=400),
  nrow=1
)
grid1
```

![annotation-1]({{site.baseurl}}/images/scrape-nicely/annotation-1.png)

*Placing a logo using plot coordinates can be painful.*

The Cowplot package will do this better by placing an image in the same relative position.

## Using Cowplot

Install Cowplot and create a function like this.

You can hard-code the file name and coordinates to the function or take them in as arguments.

```{r add-logo-fn, include=TRUE, echo=TRUE}
add_logo <- function(plots,image_path){
  plots_logo <- list()
  
  for(i in 1:length(plots)){
    name <- names(plots[i])
    plots_logo[[name]] <-
      plots[[i]] %>%
      ggdraw() +
      draw_image(image_path,
                 x=0.95,
                 y=0.95,
                 hjust=1,
                 vjust=1,
                 width=0.12,
                 height=0.12)
  }
  return(plots_logo)
}
```
```{r draw-image-code,include=TRUE,eval=FALSE}
draw_image(github_path,x=0.95,y=0.95,hjust=1,vjust=1,width=0.1,height=0.1,scale=1)
```
```{r draw-image}
grid2 <- plot_grid(
  plots$p1 %>% ggdraw() + draw_image(github_path,x=0.95,y=0.95,hjust=1,vjust=1,width=0.12,height=0.12),
  plots$p2 %>% ggdraw() + draw_image(github_path,x=0.95,y=0.95,hjust=1,vjust=1,width=0.12,height=0.12),
  nrow=1
)
grid2
```

Then call the function with your list of ggplots.

![grid-1]({{site.baseurl}}/images/scrape-nicely/draw-image-1.png)

*Adding a logo with Cowplot will place it neatly where you want.*

## Useful links
1. [https://www.datanovia.com/en/blog/ggplot-title-subtitle-and-caption/](https://www.datanovia.com/en/blog/ggplot-title-subtitle-and-caption/)
1. [https://www.rdocumentation.org/packages/cowplot/versions/1.0.0/topics/draw_image](https://www.rdocumentation.org/packages/cowplot/versions/1.0.0/topics/draw_image)
